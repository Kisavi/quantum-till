<div class="flex flex-col h-full">
  <div class="text-lg font-semibold p-4 border-b">Cart Summary</div>

  @let cartItems = cart();

  @if (cartItems.length) {
    <div class="grow overflow-auto px-4 py-3">
      <!-- Cart Items List -->
      @for (item of cartItems; track $index) {
        <div class="flex justify-between items-center py-3 border-b hover:bg-gray-50">
          <div class="flex-1">
            <div class="font-medium text-gray-800">{{ item.stockItem.product.name }}</div>
            <div class="text-sm text-gray-600">
              {{ formatQuantity(item.quantity, item.stockItem.product) }} Ã— {{ item.stockItem.product.unitPrice | currency: 'KSh ' }}
            </div>
          </div>
          <div class="flex items-center gap-3">
            <div class="font-semibold text-gray-900">
              {{ getItemTotalValue(item) | currency: 'KSh ' }}
            </div>
            <p-button 
              icon="pi pi-trash" 
              [rounded]="true"
              [text]="true"
              size="small"
              severity="danger"
              (onClick)="removeItem(item)"
            />
          </div>
        </div>
      }
    </div>
  } @else {
    <div class="grow my-24 text-center text-gray-500">
      <div class="mb-4"><i class="pi pi-receipt" style="font-size: 5rem"></i></div>
      <div class="font-semibold mb-0.5">Cart is Empty</div>
      <div class="text-sm">Use +/- buttons on products to add items</div>
    </div>
  }

  <!-- Footer -->
  <div class="bg-gray-100 rounded-b-lg border-t-2 border-slate-300 p-4">
    <div class="flex mb-3 text-lg font-semibold">
      <div class="grow">Total</div>
      <div class="text-blue-600">{{ subTotal() | currency: 'KSh ' }}</div>
    </div>

    <div class="flex gap-3">
      <p-button 
        label="Clear All" 
        icon="pi pi-trash"
        (click)="clear()" 
        severity="danger"
        [outlined]="true"
        [disabled]="cartItems.length < 1"
        class="flex-1"
      />
      <button
        pButton
        label="Checkout"
        icon="pi pi-check"
        (click)="checkout()"
        severity="success"
        class="flex-1"
        [disabled]="cartItems.length < 1"
      >
      </button>
    </div>
  </div>
</div>

<app-checkout [tripId]="tripId()" [(visible)]="checkoutDialogVisible" />
